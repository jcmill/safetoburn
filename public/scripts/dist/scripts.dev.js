function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){var o=_regenerator(),e=o.m(_regeneratorRuntime),t=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function a(e){e="function"==typeof e&&e.constructor;return!!e&&(e===t||"GeneratorFunction"===(e.displayName||e.name))}var r={throw:1,return:2,break:3,continue:3};function i(e){var o,a;return function(n){o||(o={stop:function(){return a(n.a,2)},catch:function(){return n.v},abrupt:function(e,t){return a(n.a,r[e],t)},delegateYield:function(e,t,r){return o.resultName=t,a(n.d,_regeneratorValues(e),r)},finish:function(e){return a(n.f,e)}},a=function(e,t,r){n.p=o.prev,n.n=o.next;try{return e(t,r)}finally{o.next=n.n}}),o.resultName&&(o[o.resultName]=n.v,o.resultName=void 0),o.sent=n.v,o.next=n.n;try{return e.call(this,o)}finally{n.p=o.prev,n.n=o.next}}}return(_regeneratorRuntime=function(){return{wrap:function(e,t,r,n){return o.w(i(e),t,r,n&&n.reverse())},isGeneratorFunction:a,mark:o.m,awrap:function(e,t){return new _OverloadYield(e,t)},AsyncIterator:_regeneratorAsyncIterator,async:function(e,t,r,n,o){return(a(t)?_regeneratorAsyncGen:_regeneratorAsync)(i(e),t,r,n,o)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _regeneratorKeys(e){var t,r=Object(e),n=[];for(t in r)n.unshift(t);return function e(){for(;n.length;)if((t=n.pop())in r)return e.value=t,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(e,t,r,n,o){var a=_regeneratorAsyncGen(e,t,r,n,o);return a.next().then(function(e){return e.done?e.value:a.next()})}function _regeneratorAsyncGen(e,t,r,n,o){return new _regeneratorAsyncIterator(_regenerator().w(e,t,r,n),o||Promise)}function _regeneratorAsyncIterator(c,u){var o;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(r,e,n){function t(){return new u(function(e,t){!function t(e,r,n,o){try{var a=c[e](r),i=a.value;return i instanceof _OverloadYield?u.resolve(i.v).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):u.resolve(i).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)})}catch(e){o(e)}}(r,n,e,t)})}return o=o?o.then(t,t):t()},!0)}function _regenerator(){var h,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",r=e.toStringTag||"@@toStringTag";function n(e,t,r,n){var o,a,i,c,u,s,l,f,p,t=t&&t.prototype instanceof y?t:y,t=Object.create(t.prototype);return _regeneratorDefine2(t,"_invoke",(o=e,a=r,l=n||[],f=!1,p={p:s=0,n:0,v:h,a:d,f:d.bind(h,4),d:function(e,t){return i=e,c=0,u=h,p.n=t,g}},function(e,t,r){if(1<s)throw TypeError("Generator is already running");for(f&&1===t&&d(t,r),c=t,u=r;(m=c<2?h:u)||!f;){i||(c?c<3?(1<c&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(m=i[e=c?e:"next"]){if(!(m=m.call(i,u)))throw TypeError("iterator result is not an object");if(!m.done)return m;u=m.value,c<2&&(c=0)}else 1===c&&(m=i.return)&&m.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+e+"' method"),c=1);i=h}else if((m=(f=p.n<0)?u:o.call(a,p))!==g)break}catch(e){i=h,c=1,u=e}finally{s=1}}return{value:m,done:f}}),!0),t;function d(e,t){for(c=e,u=t,m=0;!f&&s&&!r&&m<l.length;m++){var r,n=l[m],o=p.p,a=n[2];3<e?(r=a===t)&&(u=n[(c=n[4])?5:c=3],n[4]=n[5]=h):n[0]<=o&&((r=e<2&&o<n[1])?(c=0,p.v=t,p.n=n[1]):o<a&&(r=e<3||n[0]>t||a<t)&&(n[4]=e,n[5]=t,p.n=a,c=0))}if(r||1<e)return g;throw f=!0,t}}var g={};function y(){}function o(){}function a(){}var m=Object.getPrototypeOf,e=[][t]?m(m([][t]())):(_regeneratorDefine2(m={},t,function(){return this}),m),i=a.prototype=y.prototype=Object.create(e);function c(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,r,"GeneratorFunction")),e.prototype=Object.create(i),e}return _regeneratorDefine2(i,"constructor",o.prototype=a),_regeneratorDefine2(a,"constructor",o),_regeneratorDefine2(a,r,o.displayName="GeneratorFunction"),_regeneratorDefine2(i),_regeneratorDefine2(i,r,"Generator"),_regeneratorDefine2(i,t,function(){return this}),_regeneratorDefine2(i,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:n,m:c}})()}function _regeneratorDefine2(e,t,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,r,n){function o(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})}t?a?a(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(o("next",0),o("throw",1),o("return",2))})(e,t,r,n)}function _OverloadYield(e,t){this.v=e,this.k=t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}var myLocationButton=document.querySelector(".js-my-location"),form=document.querySelector("form"),input=document.querySelector(".js-location-search__input"),locationContainer=document.querySelector(".js-hero__details--response"),inputReset=document.querySelector(".js-input"),resetButton=document.querySelector(".js-reset"),dangerAlerts=[],urlSearch=window.location.search;function temporarilyThrottle(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3;e.disabled=!0,setTimeout(function(){e.disabled=!1},t)}function handleMyLocationClick(){navigator.geolocation.getCurrentPosition(function(t){var r,n;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.coords.latitude,n=t.coords.longitude,getWeatherData(r,n),getFireAlerts(r,n);case 4:case"end":return e.stop()}})},function(e){var t="Unable to retrieve your location.",e=(e.code===e.PERMISSION_DENIED?t="Location permission denied. Please allow location access.":e.code===e.POSITION_UNAVAILABLE?t="Location information is unavailable.":e.code===e.TIMEOUT&&(t="The request to get your location timed out."),document.querySelector(".js-location-search__error"));e?(e.textContent=t,e.classList.remove("c-location-search__hidden")):alert(t)})}function getJSON(t){var r;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(fetch(t,{headers:{"User-Agent":"SafeBurnApp"}}));case 2:if((r=e.sent).ok){e.next=5;break}throw new Error("Request failed: ".concat(r.status));case 5:return e.next=7,_regeneratorRuntime().awrap(r.json());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}})}function getWeather(t,r){var n,o,a,i,c;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(getJSON("https://api.weather.gov/points/".concat(t,",").concat(r)));case 2:return n=e.sent,e.next=5,_regeneratorRuntime().awrap(getJSON(n.properties.county));case 5:return o=e.sent,buildLocation(n.properties.relativeLocation.properties.city,o.properties.name,o.properties.state),o=n.properties.forecastHourly,e.next=10,_regeneratorRuntime().awrap(getJSON(o));case 10:return o=e.sent,c=new Date,a=c.getHours(),c=o.properties.periods,i=c.findIndex(function(e){return new Date(e.startTime).getHours()===a}),c=c[i],e.abrupt("return",{windSpeed:c.windSpeed,relativeHumidity:c.relativeHumidity.value,relativeLocationCity:n.properties.relativeLocation.properties.city,relativeLocationState:n.properties.relativeLocation.properties.state});case 17:case"end":return e.stop()}})}function getFireAlerts(t,r){var n,o,a,i;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(getJSON("https://api.weather.gov/alerts/active?point=".concat(t,",").concat(r)));case 2:return a=e.sent,n=["Red Flag Warning","Fire Weather Watch","Burn Ban","Air Quality Alert","High Wind Warning","Wind Advisory"],o=["Red Flag Warning","Fire Weather Watch","Burn Ban"],a=a.features.filter(function(t){return n.some(function(e){return t.properties.event&&t.properties.event.toLowerCase()===e.toLowerCase()})}),a=new Set(a.map(function(e){return e.properties.event})),a=Array.from(a),i=a.filter(function(e){return o.includes(e)}),buildAlerts(a),e.abrupt("return",i);case 11:case"end":return e.stop()}})}myLocationButton&&myLocationButton.addEventListener("click",function(e){temporarilyThrottle(myLocationButton),handleMyLocationClick()});var weatherCache={};function getWeatherData(t,r){var n,o,a;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="".concat(t,",").concat(r),weatherCache[n])return o=weatherCache[n],windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a),e.abrupt("return");e.next=8;break;case 8:return e.next=10,_regeneratorRuntime().awrap(getWeather(t,r));case 10:return o=e.sent,weatherCache[n]=o,windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,e.next=16,_regeneratorRuntime().awrap(getFireAlerts(t,r));case 16:a=e.sent,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a);case 19:case"end":return e.stop()}})}function getLocation(t){var r,n,o,a,i,c,u=arguments;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=1<u.length&&void 0!==u[1]?u[1]:"Cupertino",n=2<u.length&&void 0!==u[2]?u[2]:"CA",t)return e.next=5,_regeneratorRuntime().awrap(getJSON("https://nominatim.openstreetmap.org/search?postalcode=".concat(t,"&country=us&format=json")));e.next=12;break;case 5:if((i=e.sent).length){e.next=8;break}return e.abrupt("return");case 8:o=i[0].lat,a=i[0].lon,e.next=19;break;case 12:return e.next=14,_regeneratorRuntime().awrap(getJSON("https://nominatim.openstreetmap.org/search?city=".concat(r,"&state=").concat(n,"&format=json")));case 14:if((c=e.sent).length){e.next=17;break}return e.abrupt("return");case 17:o=c[0].lat,a=c[0].lon;case 19:return e.next=21,_regeneratorRuntime().awrap(getWeatherData(o,a));case 21:return e.next=23,_regeneratorRuntime().awrap(getFireAlerts(o,a));case 23:case"end":return e.stop()}})}var getOffset=function(){var e=1100-Math.round(8.6*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0));return Number(240<=e?e.toFixed(2):240)},readings=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=document.querySelector(".js-graph-circle--windspeed"),n=document.querySelector(".js-windspeed-text"),o=document.querySelector(".js-graph-circle--humidity"),a=document.querySelector(".js-humidity-text"),i=Number(e/15*100);r.style.strokeDashoffset=getOffset(i),n.textContent="".concat(Number(e)," mph"),o.style.strokeDashoffset=getOffset(t),a.textContent="".concat(Number(t),"%"),r.style.stroke=i<=80?"#cc9c50":100<=i?"#c94c26":"#f87819",o.style.stroke=30<t?"#cc9c50":t<=15?"#c94c26":"#f87819"};function updateContainer(e,t){e=document.querySelector(e);e&&(e.innerHTML="",e.insertAdjacentHTML("afterbegin",t))}document.addEventListener("DOMContentLoaded",function(){return setTimeout(readings,100)});var urlSearchLocation,safeToBurn=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=[],o=[],r=(15<e&&o.push("<b>High wind</b> (".concat(e," mph)")),t<15&&o.push("<b>Low humidity</b> (".concat(t,"%)")),0<r.length&&o.push.apply(o,_toConsumableArray(r.map(function(e){return"a ".concat(e)}))),11<=e&&e<=15&&n.push("<b>High wind</b> (".concat(e," mph)")),14<=t&&t<=30&&n.push("<b>Low humidity</b> (".concat(t,"%)")),n.join(" and ")),e=o.join(" and "),t='\n    <div class="c-unsafe">\n      <h3>It\'s <b>unsafe</b> to burn because '.concat(e,"</h3>\n    </div>\n  "),e='\n    <div class="c-warning">\n      <h3>Use <b>caution</b> when burning because of '.concat(r,"</h3>\n    </div>\n  ");updateContainer(".js-hero__details--response",0<o.length?t:0<n.length?e:'\n    <div class="c-safe">\n      <h2>It\'s safe to burn!</h2>\n    </div>\n  ')};function buildLocation(e,t,r){updateContainer(".js-hero__details--location","<h4>In ".concat(e,", ").concat(t," county, ").concat(r,"</h4>"))}function buildAlerts(e){1<=e.length?updateContainer(".js-hero__details--alerts","<p><b>Beware of alerts:</b> ".concat(e.join(", "),"</p>")):updateContainer(".js-hero__details--alerts","")}form.addEventListener("submit",function(t){var r,n,o,a,i;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:r=document.querySelector(".js-location-search__error"),temporarilyThrottle(input),readings(0,0),r.textContent="",r.classList.add("c-location-search__hidden"),input.removeAttribute("aria-invalid"),(n=input.value.trim())?e.next=15:(t.preventDefault(),r.textContent="Please enter a city name or ZIP code.",r.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.next=38);break;case 15:/^\d+$/.test(n)&&(n.length<5||5<n.length)?(t.preventDefault(),r.textContent="ZIP codes must be 5 digits.",r.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.next=38):e.next=23;break;case 23:if(/^\d+$/.test(n)&&5===n.length)return t.preventDefault(),e.next=27,_regeneratorRuntime().awrap(getLocation(n));e.next=29;break;case 27:e.next=38;break;case 29:if(/^\d+$/.test(n)){e.next=38;break}if(t.preventDefault(),o=n.trim().match(/^(.+)\s([a-zA-Z]{2})$/)){e.next=34;break}return e.abrupt("return");case 34:return a=o[1].trim(),i=o[2].toUpperCase(),e.next=38,_regeneratorRuntime().awrap(getLocation(null,a,i));case 38:case"end":return e.stop()}})}),urlSearch&&(urlSearchLocation=function(e){var t,r;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:r=urlSearch.slice(1).split("&"),t=r[0].slice(5),r=r[1].slice(6),getLocation(null,t,r);case 4:case"end":return e.stop()}})})();