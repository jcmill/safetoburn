function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){var o=_regenerator(),e=o.m(_regeneratorRuntime),t=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function a(e){e="function"==typeof e&&e.constructor;return!!e&&(e===t||"GeneratorFunction"===(e.displayName||e.name))}var n={throw:1,return:2,break:3,continue:3};function i(e){var o,a;return function(r){o||(o={stop:function(){return a(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return a(r.a,n[e],t)},delegateYield:function(e,t,n){return o.resultName=t,a(r.d,_regeneratorValues(e),n)},finish:function(e){return a(r.f,e)}},a=function(e,t,n){r.p=o.prev,r.n=o.next;try{return e(t,n)}finally{o.next=r.n}}),o.resultName&&(o[o.resultName]=r.v,o.resultName=void 0),o.sent=r.v,o.next=r.n;try{return e.call(this,o)}finally{r.p=o.prev,r.n=o.next}}}return(_regeneratorRuntime=function(){return{wrap:function(e,t,n,r){return o.w(i(e),t,n,r&&r.reverse())},isGeneratorFunction:a,mark:o.m,awrap:function(e,t){return new _OverloadYield(e,t)},AsyncIterator:_regeneratorAsyncIterator,async:function(e,t,n,r,o){return(a(t)?_regeneratorAsyncGen:_regeneratorAsync)(i(e),t,n,r,o)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _regeneratorKeys(e){var t,n=Object(e),r=[];for(t in n)r.unshift(t);return function e(){for(;r.length;)if((t=r.pop())in n)return e.value=t,e.done=!1,e;return e.done=!0,e}}function _regeneratorAsync(e,t,n,r,o){var a=_regeneratorAsyncGen(e,t,n,r,o);return a.next().then(function(e){return e.done?e.value:a.next()})}function _regeneratorAsyncGen(e,t,n,r,o){return new _regeneratorAsyncIterator(_regenerator().w(e,t,n,r),o||Promise)}function _regeneratorAsyncIterator(c,u){var o;this.next||(_regeneratorDefine2(_regeneratorAsyncIterator.prototype),_regeneratorDefine2(_regeneratorAsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine2(this,"_invoke",function(n,e,r){function t(){return new u(function(e,t){!function t(e,n,r,o){try{var a=c[e](n),i=a.value;return i instanceof _OverloadYield?u.resolve(i.v).then(function(e){t("next",e,r,o)},function(e){t("throw",e,r,o)}):u.resolve(i).then(function(e){a.value=e,r(a)},function(e){return t("throw",e,r,o)})}catch(e){o(e)}}(n,r,e,t)})}return o=o?o.then(t,t):t()},!0)}function _regenerator(){var h,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",n=e.toStringTag||"@@toStringTag";function r(e,t,n,r){var o,a,i,c,u,s,d,l,p,t=t&&t.prototype instanceof g?t:g,t=Object.create(t.prototype);return _regeneratorDefine2(t,"_invoke",(o=e,a=n,d=r||[],l=!1,p={p:s=0,n:0,v:h,a:f,f:f.bind(h,4),d:function(e,t){return i=e,c=0,u=h,p.n=t,m}},function(e,t,n){if(1<s)throw TypeError("Generator is already running");for(l&&1===t&&f(t,n),c=t,u=n;(y=c<2?h:u)||!l;){i||(c?c<3?(1<c&&(p.n=-1),f(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(y=i[e=c?e:"next"]){if(!(y=y.call(i,u)))throw TypeError("iterator result is not an object");if(!y.done)return y;u=y.value,c<2&&(c=0)}else 1===c&&(y=i.return)&&y.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+e+"' method"),c=1);i=h}else if((y=(l=p.n<0)?u:o.call(a,p))!==m)break}catch(e){i=h,c=1,u=e}finally{s=1}}return{value:y,done:l}}),!0),t;function f(e,t){for(c=e,u=t,y=0;!l&&s&&!n&&y<d.length;y++){var n,r=d[y],o=p.p,a=r[2];3<e?(n=a===t)&&(u=r[(c=r[4])?5:c=3],r[4]=r[5]=h):r[0]<=o&&((n=e<2&&o<r[1])?(c=0,p.v=t,p.n=r[1]):o<a&&(n=e<3||r[0]>t||a<t)&&(r[4]=e,r[5]=t,p.n=a,c=0))}if(n||1<e)return m;throw l=!0,t}}var m={};function g(){}function o(){}function a(){}var y=Object.getPrototypeOf,e=[][t]?y(y([][t]())):(_regeneratorDefine2(y={},t,function(){return this}),y),i=a.prototype=g.prototype=Object.create(e);function c(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,n,"GeneratorFunction")),e.prototype=Object.create(i),e}return _regeneratorDefine2(i,"constructor",o.prototype=a),_regeneratorDefine2(a,"constructor",o),_regeneratorDefine2(a,n,o.displayName="GeneratorFunction"),_regeneratorDefine2(i),_regeneratorDefine2(i,n,"Generator"),_regeneratorDefine2(i,t,function(){return this}),_regeneratorDefine2(i,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:r,m:c}})()}function _regeneratorDefine2(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,n,r){function o(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function _OverloadYield(e,t){this.v=e,this.k=t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var locationLoadTime,weatherLoadTime,myLocationButton=document.querySelectorAll(".js-btn-location"),searchButton=document.querySelector(".js-btn-search"),searchForm=document.querySelector(".js-location-search"),input=document.querySelector(".js-location-search__input"),inputReset=document.querySelector(".js-input"),resetButton=document.querySelector(".js-reset"),dangerAlerts=[],urlSearch=window.location.search;function temporarilyThrottle(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3;e.disabled=!0,setTimeout(function(){e.disabled=!1},t)}function handleMyLocationClick(){navigator.geolocation.getCurrentPosition(function(t){var n,r;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.coords.latitude,r=t.coords.longitude,getWeatherData(n,r),getFireAlerts(n,r),locationLoadTime=Math.round(performance.now()),hideBlueIcons(locationLoadTimeShort=Number(locationLoadTime.toString().slice(0,-1)));case 7:case"end":return e.stop()}})},function(e){var t="Unable to retrieve your location.",e=(e.code===e.PERMISSION_DENIED?t="Location permission denied. Please allow location access.":e.code===e.POSITION_UNAVAILABLE?t="Location information is unavailable.":e.code===e.TIMEOUT&&(t="The request to get your location timed out."),document.querySelector(".js-location-search__error"));e?(e.textContent=t,e.classList.remove("c-location-search__hidden")):alert(t)})}function hideBlueIcons(e){var t=document.querySelector(".js-windspeed-graph-icon--blue"),n=document.querySelector(".js-humidity-graph-icon--blue");setTimeout(function(){t.classList.add("u-icon-hidden"),n.classList.add("u-icon-hidden")},e)}function addFocusVisible(e){e.classList.add("focus-visible")}function removeFocusVisible(e){e.classList.remove("focus-visible")}function getJSON(t){var n;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(fetch(t,{headers:{"User-Agent":"SafeBurnApp"}}));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Request failed: ".concat(n.status));case 5:return e.next=7,_regeneratorRuntime().awrap(n.json());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}})}function getWeather(t,n){var r,o,a,i,c,u,s,d,l,p;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(getJSON("https://api.weather.gov/points/".concat(t,",").concat(n)));case 2:return r=e.sent,e.next=5,_regeneratorRuntime().awrap(getJSON(r.properties.county));case 5:return o=e.sent,buildLocation(r.properties.relativeLocation.properties.city,o.properties.name,o.properties.state),a=r.properties.forecastHourly,e.next=10,_regeneratorRuntime().awrap(getJSON(a));case 10:return a=e.sent,p=o.properties.timeZone[0],p=new Intl.DateTimeFormat("en",{timeZone:p,timeZoneName:"longOffset",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),p=p.formatToParts(new Date),i=p.find(function(e){return"timeZoneName"===e.type}).value.slice(4),c=p.find(function(e){return"day"===e.type}).value.toString(),u=p.find(function(e){return"month"===e.type}).value.toString(),s=p.find(function(e){return"year"===e.type}).value.toString(),d=p.find(function(e){return"hour"===e.type}).value.toString(),p=a.properties.periods,console.log("".concat(s,"-").concat(u,"-").concat(c,"T").concat(d,":00:00-").concat(i),p),l=p.findIndex(function(e){return e.startTime.startsWith("".concat(s,"-").concat(u,"-").concat(c,"T").concat(d,":00:00-").concat(i))}),p=p[l],e.abrupt("return",{windSpeed:p.windSpeed,relativeHumidity:p.relativeHumidity.value,relativeLocationCity:r.properties.relativeLocation.properties.city,relativeLocationState:r.properties.relativeLocation.properties.state});case 24:case"end":return e.stop()}})}function getFireAlerts(t,n){var r,o,a,i;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_regeneratorRuntime().awrap(getJSON("https://api.weather.gov/alerts/active?point=".concat(t,",").concat(n)));case 2:return a=e.sent,r=["Red Flag Warning","Fire Weather Watch","Burn Ban","Air Quality Alert","High Wind Warning","Wind Advisory"],o=["Red Flag Warning","Fire Weather Watch","Burn Ban"],a=a.features.filter(function(t){return r.some(function(e){return t.properties.event&&t.properties.event.toLowerCase()===e.toLowerCase()})}),a=new Set(a.map(function(e){return e.properties.event})),a=Array.from(a),i=a.filter(function(e){return o.includes(e)}),buildAlerts(a),e.abrupt("return",i);case 11:case"end":return e.stop()}})}myLocationButton.forEach(function(e){e.addEventListener("click",function(e){temporarilyThrottle(myLocationButton),handleMyLocationClick()})}),input.addEventListener("blur",function(){removeFocusVisible(input)}),searchButton.addEventListener("click",function(e){addFocusVisible(input)});var weatherCache={};function getWeatherData(t,n){var r,o,a;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="".concat(t,",").concat(n),weatherCache[r])return o=weatherCache[r],windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a),e.abrupt("return");e.next=8;break;case 8:return e.next=10,_regeneratorRuntime().awrap(getWeather(t,n));case 10:return o=e.sent,weatherCache[r]=o,windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,e.next=16,_regeneratorRuntime().awrap(getFireAlerts(t,n));case 16:a=e.sent,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a),weatherLoadTime=Math.round(performance.now()),hideBlueIcons(weatherLoadTimeShort=Number(weatherLoadTime.toString().slice(0,-1)));case 22:case"end":return e.stop()}})}function getLocation(t){var n,r,o,a,i,c,u=arguments;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=1<u.length&&void 0!==u[1]?u[1]:"Cupertino",r=2<u.length&&void 0!==u[2]?u[2]:"CA",t)return e.next=5,_regeneratorRuntime().awrap(getJSON("https://nominatim.openstreetmap.org/search?postalcode=".concat(t,"&country=us&format=json")));e.next=12;break;case 5:if((i=e.sent).length){e.next=8;break}return e.abrupt("return");case 8:o=i[0].lat,a=i[0].lon,e.next=19;break;case 12:return e.next=14,_regeneratorRuntime().awrap(getJSON("https://nominatim.openstreetmap.org/search?city=".concat(n,"&state=").concat(r,"&format=json")));case 14:if((c=e.sent).length){e.next=17;break}return e.abrupt("return");case 17:o=c[0].lat,a=c[0].lon;case 19:return e.next=21,_regeneratorRuntime().awrap(getWeatherData(o,a));case 21:return e.next=23,_regeneratorRuntime().awrap(getFireAlerts(o,a));case 23:case"end":return e.stop()}})}var getOffset=function(){var e=1100-Math.round(8.6*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0));return Number(240<=e?e.toFixed(2):240)},readings=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;handleWindspeedGraph(e),handleHumidityGraph(t)};function handleWindspeedGraph(e){var t=document.querySelector(".js-graph-circle--windspeed"),n=document.querySelector(".js-windspeed-text"),r=document.querySelector(".js-windspeed-graph-icon--green"),o=document.querySelector(".js-windspeed-graph-icon--orange"),a=document.querySelector(".js-windspeed-graph-icon--red"),i=Number(e/20*100);t.style.strokeDashoffset=getOffset(i),n.textContent="".concat(Number(e)," mph"),i<=75&&0<i?(t.style.stroke="#cc9c50",r.classList.remove("u-icon-hidden"),o.classList.add("u-icon-hidden"),a.classList.add("u-icon-hidden")):76<i&&i<100?(t.style.stroke="#f87819",r.classList.add("u-icon-hidden"),o.classList.remove("u-icon-hidden"),a.classList.add("u-icon-hidden")):100===i&&(t.style.stroke="#c94c26",r.classList.add("u-icon-hidden"),o.classList.add("u-icon-hidden"),a.classList.remove("u-icon-hidden"))}function handleHumidityGraph(e){var t=document.querySelector(".js-humidity-graph-icon--green"),n=document.querySelector(".js-humidity-graph-icon--orange"),r=document.querySelector(".js-humidity-graph-icon--red"),o=document.querySelector(".js-graph-circle--humidity"),a=document.querySelector(".js-humidity-text");o.style.strokeDashoffset=getOffset(e),a.textContent="".concat(Number(e),"%"),40<=e?(o.style.stroke="#cc9c50",t.classList.remove("u-icon-hidden"),n.classList.add("u-icon-hidden"),r.classList.add("u-icon-hidden")):15<e&&e<40?(o.style.stroke="#f87819",t.classList.add("u-icon-hidden"),n.classList.remove("u-icon-hidden"),r.classList.add("u-icon-hidden")):e<=15&&(o.style.stroke="#c94c26",t.classList.add("u-icon-hidden"),n.classList.add("u-icon-hidden"),r.classList.remove("u-icon-hidden"))}function updateContainer(e,t){e=document.querySelector(e);e&&(e.innerHTML="",e.insertAdjacentHTML("afterbegin",t))}document.addEventListener("DOMContentLoaded",function(){return setTimeout(readings,100)});var urlSearchLocation,safeToBurn=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=[],o=[],a=[],n=(20<e&&o.push("<b>High wind</b> (".concat(e," mph)")),t<15&&o.push("<b>Low humidity</b> (".concat(t,"%)")),0<n.length&&o.push.apply(o,_toConsumableArray(n.map(function(e){return"a ".concat(e)}))),15<e&&e<=20&&r.push("<b>High wind</b> (".concat(e," mph)")),14<=t&&t<30&&r.push("<b>Low humidity</b> (".concat(t,"%)")),e<=15&&a.push("Windspeed"),30<t&&a.push("Humidity"),r.join(" and ")),e=o.join(" and "),t='\n    <div class="c-safe">\n      <h2>It\'s safe to burn!</h2>\n      <div>\n        <img src="../images/vectors/icon-check.svg" alt="check mark icon">\n        <p>'.concat(a[0],'</p>\n        <img src="../images/vectors/icon-check.svg" alt="check mark icon">\n        <p>').concat(a[1],"</p>\n      </div>\n    </div>\n  "),a='\n    <div class="c-unsafe">\n      <h2>It\'s <b>unsafe</b></h2> \n      <div>\n        <img src="../images/vectors/icon-x.svg" alt="danger icon">\n        <p>'.concat(e,"</p>\n      </div>\n    </div>\n  "),e='\n    <div class="c-warning">\n      <h2>Use <b>caution</b></h2>\n      <div> \n        <img src="../images/vectors/icon-warning.svg" alt="warning icon">\n        <p>'.concat(n,"</p>\n      </div>\n    </div>\n  ");updateContainer(".js-hero__details--response",0<o.length?a:0<r.length?e:t)};function buildLocation(e,t,n){updateContainer(".js-app__location--details","In ".concat(e,", ").concat(t," county, ").concat(n))}function buildAlerts(e){1<=e.length?updateContainer(".js-hero__details--alerts","<h4>".concat(e.join(", "),"</h4>")):updateContainer(".js-hero__details--alerts","<h4>No alerts for this area</h4>")}searchForm.addEventListener("submit",function(t){var n,r,o,a,i;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:n=document.querySelector(".js-location-search__error"),temporarilyThrottle(input),readings(0,0),n.textContent="",n.classList.add("c-location-search__hidden"),input.removeAttribute("aria-invalid"),(r=input.value.trim())?e.next=15:(t.preventDefault(),n.textContent="Please enter a city name or ZIP code.",n.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.next=38);break;case 15:/^\d+$/.test(r)&&(r.length<5||5<r.length)?(t.preventDefault(),n.textContent="ZIP codes must be 5 digits.",n.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.next=38):e.next=23;break;case 23:if(/^\d+$/.test(r)&&5===r.length)return t.preventDefault(),e.next=27,_regeneratorRuntime().awrap(getLocation(r));e.next=29;break;case 27:e.next=38;break;case 29:if(/^\d+$/.test(r)){e.next=38;break}if(t.preventDefault(),o=r.trim().match(/^(.+)\s([a-zA-Z]{2})$/)){e.next=34;break}return e.abrupt("return");case 34:return a=o[1].trim(),i=o[2].toUpperCase(),e.next=38,_regeneratorRuntime().awrap(getLocation(null,a,i));case 38:case"end":return e.stop()}})}),urlSearch&&(urlSearchLocation=function(e){var t,n;return _regeneratorRuntime().async(function(e){for(;;)switch(e.prev=e.next){case 0:n=urlSearch.slice(1).split("&"),t=n[0].slice(5),n=n[1].slice(6),getLocation(null,t,n);case 4:case"end":return e.stop()}})})();