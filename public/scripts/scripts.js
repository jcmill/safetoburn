function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _regenerator(){var f,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",n=e.toStringTag||"@@toStringTag";function r(e,t,n,r){var o,a,i,c,s,u,d,l,h,t=t&&t.prototype instanceof m?t:m,t=Object.create(t.prototype);return _regeneratorDefine2(t,"_invoke",(o=e,a=n,d=r||[],l=!1,h={p:u=0,n:0,v:f,a:p,f:p.bind(f,4),d:function(e,t){return i=e,c=0,s=f,h.n=t,g}},function(e,t,n){if(1<u)throw TypeError("Generator is already running");for(l&&1===t&&p(t,n),c=t,s=n;(y=c<2?f:s)||!l;){i||(c?c<3?(1<c&&(h.n=-1),p(c,s)):h.n=s:h.v=s);try{if(u=2,i){if(y=i[e=c?e:"next"]){if(!(y=y.call(i,s)))throw TypeError("iterator result is not an object");if(!y.done)return y;s=y.value,c<2&&(c=0)}else 1===c&&(y=i.return)&&y.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+e+"' method"),c=1);i=f}else if((y=(l=h.n<0)?s:o.call(a,h))!==g)break}catch(e){i=f,c=1,s=e}finally{u=1}}return{value:y,done:l}}),!0),t;function p(e,t){for(c=e,s=t,y=0;!l&&u&&!n&&y<d.length;y++){var n,r=d[y],o=h.p,a=r[2];3<e?(n=a===t)&&(s=r[(c=r[4])?5:c=3],r[4]=r[5]=f):r[0]<=o&&((n=e<2&&o<r[1])?(c=0,h.v=t,h.n=r[1]):o<a&&(n=e<3||r[0]>t||a<t)&&(r[4]=e,r[5]=t,h.n=a,c=0))}if(n||1<e)return g;throw l=!0,t}}var g={};function m(){}function o(){}function a(){}var y=Object.getPrototypeOf,e=[][t]?y(y([][t]())):(_regeneratorDefine2(y={},t,function(){return this}),y),i=a.prototype=m.prototype=Object.create(e);function c(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,n,"GeneratorFunction")),e.prototype=Object.create(i),e}return _regeneratorDefine2(i,"constructor",o.prototype=a),_regeneratorDefine2(a,"constructor",o),_regeneratorDefine2(a,n,o.displayName="GeneratorFunction"),_regeneratorDefine2(i),_regeneratorDefine2(i,n,"Generator"),_regeneratorDefine2(i,t,function(){return this}),_regeneratorDefine2(i,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:r,m:c}})()}function _regeneratorDefine2(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,n,r){function o(t,n){_regeneratorDefine2(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))})(e,t,n,r)}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,n){var r=c.apply(e,i);function o(e){asyncGeneratorStep(r,t,n,o,a,"next",e)}function a(e){asyncGeneratorStep(r,t,n,o,a,"throw",e)}o(void 0)})}}var locationLoadTime,weatherLoadTime,myLocationButton=document.querySelectorAll(".js-btn-location"),searchButton=document.querySelector(".js-btn-search"),searchForm=document.querySelector(".js-location-search"),input=document.querySelector(".js-location-search__input"),inputReset=document.querySelector(".js-input"),resetButton=document.querySelector(".js-reset"),dangerAlerts=[],urlSearch=window.location.search;function temporarilyThrottle(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2e3;e.disabled=!0,setTimeout(function(){e.disabled=!1},t)}function handleMyLocationClick(){navigator.geolocation.getCurrentPosition((()=>{var t=_asyncToGenerator(_regenerator().m(function e(t){var n,r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:n=t.coords.latitude,r=t.coords.longitude,getWeatherData(n,r),getFireAlerts(n,r),getAqi(n,r),locationLoadTime=Math.round(performance.now()),hideBlueIcons(locationLoadTimeShort=Number(locationLoadTime.toString().slice(0,-1)));case 1:return e.a(2)}},e)}));return function(e){return t.apply(this,arguments)}})(),function(e){var t="Unable to retrieve your location.",e=(e.code===e.PERMISSION_DENIED?t="Location permission denied. Please allow location access.":e.code===e.POSITION_UNAVAILABLE?t="Location information is unavailable.":e.code===e.TIMEOUT&&(t="The request to get your location timed out."),document.querySelector(".js-location-search__error"));e?(e.textContent=t,e.classList.remove("c-location-search__hidden")):alert(t)})}function hideBlueIcons(e){var t=document.querySelector(".js-windspeed-graph-icon--blue"),n=document.querySelector(".js-humidity-graph-icon--blue");setTimeout(function(){t.classList.add("u-icon-hidden"),n.classList.add("u-icon-hidden")},e)}function addFocusVisible(e){e.classList.add("focus-visible")}function removeFocusVisible(e){e.classList.remove("focus-visible")}function getJSON(e){return _getJSON.apply(this,arguments)}function _getJSON(){return(_getJSON=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,fetch(t,{headers:{"User-Agent":"SafeBurnApp"}});case 1:if((n=e.v).ok){e.n=2;break}throw new Error("Request failed: ".concat(n.status));case 2:return e.n=3,n.json();case 3:return e.a(2,e.v)}},e)}))).apply(this,arguments)}function getWeather(e,t){return _getWeather.apply(this,arguments)}function _getWeather(){return(_getWeather=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o,a,i,c,s,u,d,l,h;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,getJSON("https://api.weather.gov/points/".concat(t,",").concat(n));case 1:return r=e.v,e.n=2,getJSON(r.properties.county);case 2:return o=e.v,buildLocation(r.properties.relativeLocation.properties.city,o.properties.name,o.properties.state),a=r.properties.forecastHourly,e.n=3,getJSON(a);case 3:return a=e.v,h=o.properties.timeZone[0],h=new Intl.DateTimeFormat("en",{timeZone:h,timeZoneName:"longOffset",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),h=h.formatToParts(new Date),i=h.find(function(e){return"timeZoneName"===e.type}).value.slice(4),c=h.find(function(e){return"day"===e.type}).value.toString(),s=h.find(function(e){return"month"===e.type}).value.toString(),u=h.find(function(e){return"year"===e.type}).value.toString(),d=h.find(function(e){return"hour"===e.type}).value.toString(),h=a.properties.periods,l=h.findIndex(function(e){return e.startTime.startsWith("".concat(u,"-").concat(s,"-").concat(c,"T").concat(d,":00:00-").concat(i))}),h=h[l],e.a(2,{windSpeed:h.windSpeed,relativeHumidity:h.relativeHumidity.value,relativeLocationCity:r.properties.relativeLocation.properties.city,relativeLocationState:r.properties.relativeLocation.properties.state})}},e)}))).apply(this,arguments)}function getFireAlerts(e,t){return _getFireAlerts.apply(this,arguments)}function _getFireAlerts(){return(_getFireAlerts=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o,a,i;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,getJSON("https://api.weather.gov/alerts/active?point=".concat(t,",").concat(n));case 1:return a=e.v,r=["Red Flag Warning","Fire Weather Watch","Burn Ban","Air Quality Alert","High Wind Warning","Wind Advisory"],o=["Red Flag Warning","Fire Weather Watch","Burn Ban"],a=a.features.filter(function(t){return r.some(function(e){return t.properties.event&&t.properties.event.toLowerCase()===e.toLowerCase()})}),a=new Set(a.map(function(e){return e.properties.event})),a=Array.from(a),i=a.filter(function(e){return o.includes(e)}),buildAlerts(a),e.a(2,i)}},e)}))).apply(this,arguments)}function getAqi(e,t){return _getAqi.apply(this,arguments)}function _getAqi(){return(_getAqi=_asyncToGenerator(_regenerator().m(function e(t,n){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,getJSON("https://www.airnowapi.org/aq/forecast/latLong/?format=application/json&latitude=".concat(t,"&longitude=").concat(n,"&distance=25&api_key=").concat("6F917D1F-9A17-4091-B834-7BF2A1EABBC0"));case 1:r=e.v,console.log(r[0]);case 2:return e.a(2)}},e)}))).apply(this,arguments)}myLocationButton.forEach(function(e){e.addEventListener("click",function(e){temporarilyThrottle(myLocationButton),handleMyLocationClick()})}),input.addEventListener("blur",function(){removeFocusVisible(input)}),searchButton.addEventListener("click",function(e){addFocusVisible(input)});var weatherCache={};function getWeatherData(e,t){return _getWeatherData.apply(this,arguments)}function _getWeatherData(){return(_getWeatherData=_asyncToGenerator(_regenerator().m(function e(t,n){var r,o,a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r="".concat(t,",").concat(n),weatherCache[r])return o=weatherCache[r],windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a),e.a(2);e.n=1;break;case 1:return e.n=2,getWeather(t,n);case 2:return o=e.v,weatherCache[r]=o,windspeed=parseFloat(o.windSpeed.replace("mph","").trim()),humidity=o.relativeHumidity,e.n=3,getFireAlerts(t,n);case 3:a=e.v,readings(windspeed,humidity),safeToBurn(windspeed,humidity,a),weatherLoadTime=Math.round(performance.now()),hideBlueIcons(weatherLoadTimeShort=Number(weatherLoadTime.toString().slice(0,-1)));case 4:return e.a(2)}},e)}))).apply(this,arguments)}function getLocation(e){return _getLocation.apply(this,arguments)}function _getLocation(){return(_getLocation=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o,a,i,c,s=arguments;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(n=1<s.length&&void 0!==s[1]?s[1]:"Cupertino",r=2<s.length&&void 0!==s[2]?s[2]:"CA",t)return e.n=1,getJSON("https://nominatim.openstreetmap.org/search?postalcode=".concat(t,"&country=us&format=json"));e.n=3;break;case 1:if((i=e.v).length){e.n=2;break}return e.a(2);case 2:o=i[0].lat,a=i[0].lon,e.n=6;break;case 3:return e.n=4,getJSON("https://nominatim.openstreetmap.org/search?city=".concat(n,"&state=").concat(r,"&format=json"));case 4:if((c=e.v).length){e.n=5;break}return e.a(2);case 5:o=c[0].lat,a=c[0].lon;case 6:return e.n=7,getWeatherData(o,a);case 7:return e.n=8,getFireAlerts(o,a);case 8:return e.a(2)}},e)}))).apply(this,arguments)}var getOffset=function(){var e=1100-Math.round(8.6*(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0));return Number(240<=e?e.toFixed(2):240)},readings=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;handleWindspeedGraph(e),handleHumidityGraph(t)};function handleWindspeedGraph(e){var t=document.querySelector(".js-graph-circle--windspeed"),n=document.querySelector(".js-windspeed-text"),r=document.querySelector(".js-windspeed-graph-icon--green"),o=document.querySelector(".js-windspeed-graph-icon--orange"),a=document.querySelector(".js-windspeed-graph-icon--red"),i=Number(e/20*100);t.style.strokeDashoffset=getOffset(i),n.textContent="".concat(Number(e)," mph"),i<=75&&0<i?(t.style.stroke="#cc9c50",r.classList.remove("u-icon-hidden"),o.classList.add("u-icon-hidden"),a.classList.add("u-icon-hidden")):76<i&&i<100?(t.style.stroke="#f87819",r.classList.add("u-icon-hidden"),o.classList.remove("u-icon-hidden"),a.classList.add("u-icon-hidden")):100===i&&(t.style.stroke="#c94c26",r.classList.add("u-icon-hidden"),o.classList.add("u-icon-hidden"),a.classList.remove("u-icon-hidden"))}function handleHumidityGraph(e){var t=document.querySelector(".js-humidity-graph-icon--green"),n=document.querySelector(".js-humidity-graph-icon--orange"),r=document.querySelector(".js-humidity-graph-icon--red"),o=document.querySelector(".js-graph-circle--humidity"),a=document.querySelector(".js-humidity-text");o.style.strokeDashoffset=getOffset(e),a.textContent="".concat(Number(e),"%"),40<=e?(o.style.stroke="#cc9c50",t.classList.remove("u-icon-hidden"),n.classList.add("u-icon-hidden"),r.classList.add("u-icon-hidden")):15<e&&e<40?(o.style.stroke="#f87819",t.classList.add("u-icon-hidden"),n.classList.remove("u-icon-hidden"),r.classList.add("u-icon-hidden")):e<=15&&(o.style.stroke="#c94c26",t.classList.add("u-icon-hidden"),n.classList.add("u-icon-hidden"),r.classList.remove("u-icon-hidden"))}function updateContainer(e,t){e=document.querySelector(e);e&&(e.innerHTML="",e.insertAdjacentHTML("afterbegin",t))}document.addEventListener("DOMContentLoaded",function(){return setTimeout(readings,100)});var urlSearchLocation,safeToBurn=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=[],o=[],a=[],n=(20<e&&o.push("<b>High wind</b> (".concat(e," mph)")),t<15&&o.push("<b>Low humidity</b> (".concat(t,"%)")),0<n.length&&o.push.apply(o,_toConsumableArray(n.map(function(e){return"a ".concat(e)}))),15<e&&e<=20&&r.push("<b>High wind</b> (".concat(e," mph)")),14<=t&&t<30&&r.push("<b>Low humidity</b> (".concat(t,"%)")),e<=15&&a.push("Windspeed"),30<t&&a.push("Humidity"),r.join(" and ")),e=o.join(" and "),t='\n    <div class="c-safe">\n      <h2>It\'s safe to burn!</h2>\n      <div>\n        <img src="../images/vectors/icon-check.svg" alt="check mark icon">\n        <p>'.concat(a[0],'</p>\n        <img src="../images/vectors/icon-check.svg" alt="check mark icon">\n        <p>').concat(a[1],"</p>\n      </div>\n    </div>\n  "),a='\n    <div class="c-unsafe">\n      <h2>It\'s <b>unsafe</b></h2> \n      <div>\n        <img src="../images/vectors/icon-x.svg" alt="danger icon">\n        <p>'.concat(e,"</p>\n      </div>\n    </div>\n  "),e='\n    <div class="c-warning">\n      <h2>Use <b>caution</b></h2>\n      <div> \n        <img src="../images/vectors/icon-warning.svg" alt="warning icon">\n        <p>'.concat(n,"</p>\n      </div>\n    </div>\n  ");updateContainer(".js-hero__details--response",0<o.length?a:0<r.length?e:t)};function buildLocation(e,t,n){updateContainer(".js-app__location--details","In ".concat(e,", ").concat(t," county, ").concat(n))}function buildAlerts(e){1<=e.length?updateContainer(".js-hero__details--alerts","<h4>".concat(e.join(", "),"</h4>")):updateContainer(".js-hero__details--alerts","<h4>No alerts for this area</h4>")}searchForm.addEventListener("submit",(()=>{var t=_asyncToGenerator(_regenerator().m(function e(t){var n,r,o,a,i;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:n=document.querySelector(".js-location-search__error"),temporarilyThrottle(input),readings(0,0),n.textContent="",n.classList.add("c-location-search__hidden"),input.removeAttribute("aria-invalid"),(r=input.value.trim())?e.n=1:(t.preventDefault(),n.textContent="Please enter a city name or ZIP code.",n.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.n=6);break;case 1:/^\d+$/.test(r)&&(r.length<5||5<r.length)?(t.preventDefault(),n.textContent="ZIP codes must be 5 digits.",n.classList.remove("c-location-search__hidden"),input.setAttribute("aria-invalid","true"),input.focus(),e.n=6):e.n=2;break;case 2:if(/^\d+$/.test(r)&&5===r.length)return t.preventDefault(),e.n=3,getLocation(r);e.n=4;break;case 3:e.n=6;break;case 4:if(/^\d+$/.test(r)){e.n=6;break}if(t.preventDefault(),o=r.trim().match(/^(.+)\s([a-zA-Z]{2})$/)){e.n=5;break}return e.a(2);case 5:return a=o[1].trim(),i=o[2].toUpperCase(),e.n=6,getLocation(null,a,i);case 6:return e.a(2)}},e)}));return function(e){return t.apply(this,arguments)}})()),urlSearch&&(urlSearchLocation=(()=>{var t=_asyncToGenerator(_regenerator().m(function e(t){var n,r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:r=urlSearch.slice(1).split("&"),n=r[0].slice(5),r=r[1].slice(6),getLocation(null,n,r);case 1:return e.a(2)}},e)}));return function(e){return t.apply(this,arguments)}})())();